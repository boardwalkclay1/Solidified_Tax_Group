<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Client Portal ‚Äì Solidified Tax Group</title>
  <link rel="stylesheet" href="styles/style.css" />
</head>

<body>

<!-- TOPBAR -->
<header class="topbar">
  <div class="st-logo">
    <span class="st-s">S</span>
    <span class="st-t">T</span>
    <span class="st-dot-left"></span>
    <span class="st-dot-top"></span>
  </div>

  <nav>
    <a href="index.html">Home</a>
    <a href="client.html">Client Portal</a>
    <a href="client-intake.html">Client Intake</a>
    <a href="contact.html">Contact</a>
  </nav>
</header>

<main class="page">

  <!-- LOGIN CARD -->
  <section class="card">
    <h2>Client Portal Login</h2>
    <p>Access your dashboard, documents, and tax services.</p>

    <form id="clientLoginForm" class="form">
      <input type="email" name="email" placeholder="Email" required />
      <input type="tel" name="phone" placeholder="Phone Number" required />
      <input type="password" name="password" placeholder="Password" required />
      <button type="submit" class="btn">Enter Portal</button>
      <p id="loginMsg" style="margin-top:10px;"></p>
    </form>
  </section>

  <!-- QUICK ACTIONS -->
  <section class="card">
    <h2>Quick Actions</h2>

    <div class="service-grid">

      <div class="service-item" onclick="goTo('client-dashboard.html')">
        <span class="paper-emoji">üìä</span>
        <h3>Dashboard</h3>
        <p>View your tax overview and status.</p>
      </div>

      <div class="service-item" onclick="goTo('client-documents.html')">
        <span class="paper-emoji">üìÅ</span>
        <h3>Documents</h3>
        <p>View and download your uploaded documents.</p>
      </div>

      <div class="service-item" onclick="goTo('client-intake.html')">
        <span class="paper-emoji">üìù</span>
        <h3>Client Intake</h3>
        <p>Complete your intake form and upload required info.</p>
      </div>

      <div class="service-item" onclick="goTo('client-upload.html')">
        <span class="paper-emoji">üì§</span>
        <h3>Upload Documents</h3>
        <p>Upload IDs, W‚Äë2s, 1099s, and more.</p>
      </div>

    </div>
  </section>

</main>

<script>
/* NAVIGATION */
function goTo(page) {
  window.location.href = page;
}

/* LOGIN HANDLER */
document.getElementById("clientLoginForm").addEventListener("submit", async (e) => {
  e.preventDefault();
  const msg = document.getElementById("loginMsg");
  msg.textContent = "Signing in...";

  const form = e.target;
  const email = form.email.value.trim();
  const phone = form.phone.value.trim();
  const password = form.password.value.trim();

  try {
    const res = await fetch("/api/client/login", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ email, phone, password })
    });

    const data = await res.json();

    if (!data.success) {
      msg.textContent = data.error || "Login failed.";
      msg.style.color = "red";
      return;
    }

    localStorage.setItem("clientEmail", email);
    msg.textContent = "Login successful. Redirecting...";
    msg.style.color = "green";

    const selectedService = localStorage.getItem("selectedService");

    if (selectedService === "document-upload") {
      window.location.href = "client-upload.html";
    } else if (selectedService === "sign-documents") {
      window.location.href = "client-documents.html";
    } else {
      window.location.href = "client-dashboard.html";
    }

  } catch (err) {
    msg.textContent = "Error connecting to server.";
    msg.style.color = "red";
  }
});
</script>

</body>
</html>
